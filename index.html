<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>Let's go Run!</title>

<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
html, body {
  width: 100%;
  height: 100%;
  overflow: hidden;
  font-family: "Press Start 2P", cursive;
  touch-action: manipulation;
}

/* BACKGROUND */
body {
  background: url('bg.gif') no-repeat center center fixed;
  background-size: cover;
}

.game {
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
}

/* PLAYER */
.player {
  position: absolute;
  left: 10%;
  bottom: 10%;
  width: 130px;
  transition: transform 0.05s linear;
}

/* OBSTACLE */
.obstacle {
  position: absolute;
  bottom: 10%;
  width: 35px;
  left: 85%;
}

/* UI */
#startText {
  position: absolute;
  top: 40%;
  width: 100%;
  text-align: center;
  font-size: 3vw;
  color: #ff0066;
  animation: blink 1.5s infinite;
  pointer-events: none;
}
@keyframes blink {
  0%,100% { opacity:1 }
  50% { opacity:0.4 }
}

#score {
  position: absolute;
  top: 20px;
  right: 30px;
  font-size: 18px;
  color: #ff0066;
}

/* SOUND BUTTON */
#soundBtn {
  position: absolute;
  top: 20px;
  left: 20px;
  font-size: 20px;
  padding: 10px;
  background: rgba(0,0,0,0.5);
  color: white;
  border-radius: 10px;
  cursor: pointer;
  z-index: 999;
}

/* GAME OVER */
#gameOver {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.85);
  color: white;
  display: none;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  gap: 20px;
  text-align: center;
  z-index: 1000;
}

#restart {
  padding: 16px 30px;
  font-size: 16px;
  font-family:"Press Start 2P", cursive;
  cursor: pointer;
  background: #ff69b4;
  border: none;
  border-radius: 10px;
  color: white;
}

/* FLOATING GIFS */
.floating { position: absolute; pointer-events: none; }
.cloudGif { width: 150px; }
.birdGif { width: 120px; }
.butterflyGif { width: 120px; }
.beeGif { width: 120px; }
</style>
</head>

<body>
<div class="game" id="game">
  <div id="soundBtn">üîä</div>

  <img src="player.gif" class="player" id="player" />
  <img src="obstacle.png" class="obstacle" id="obstacle" />

  <div id="startText">SPACE / TAP TO JUMP üéÆ</div>
  <div id="score">0</div>
</div>

<div id="gameOver">
  <div>GAME OVER ‚ö†Ô∏è</div>
  <div id="finalScore"></div>
  <button id="restart">PLAY AGAIN</button>
</div>

<!-- AUDIO -->
<audio id="jumpSound" src="jump.wav" preload="auto"></audio>
<audio id="gameOverSound" src="gameover.wav" preload="auto"></audio>
<audio id="bgm" src="bgm.mp3" loop preload="auto"></audio>

<script>
const game = document.getElementById("game");
const player = document.getElementById("player");
const obstacle = document.getElementById("obstacle");
const scoreText = document.getElementById("score");
const startText = document.getElementById("startText");
const gameOverScreen = document.getElementById("gameOver");
const finalScore = document.getElementById("finalScore");
const restartBtn = document.getElementById("restart");
const soundBtn = document.getElementById("soundBtn");

const jumpSound = document.getElementById("jumpSound");
const gameOverSound = document.getElementById("gameOverSound");
const bgm = document.getElementById("bgm");

let soundOn = true;
let running = false;
let isGameOver = false;
let score = 0;
let y = 0;
let velocity = 0;
let obstacleX = window.innerWidth;
let speed = 4;

/* üîì MOBILE AUDIO UNLOCK */
let audioUnlocked = false;
function unlockAudio() {
  if (audioUnlocked) return;
  [bgm, jumpSound, gameOverSound].forEach(a => {
    a.play().then(() => a.pause()).catch(()=>{});
  });
  audioUnlocked = true;
}

/* SOUND TOGGLE */
soundBtn.addEventListener("click", () => {
  unlockAudio();
  soundOn = !soundOn;
  soundBtn.textContent = soundOn ? "üîä" : "üîá";
  if (soundOn && running) bgm.play();
  else bgm.pause();
});

/* GAME LOOP */
function gameLoop() {
  if (!running) return;

  velocity += -0.8;
  y += velocity;
  if (y < 0) { y = 0; velocity = 0; }
  player.style.transform = `translateY(${-y}px)`;

  obstacleX -= speed;
  obstacle.style.left = obstacleX + "px";

  if (obstacleX < -100) {
    score++;
    scoreText.textContent = score;
    obstacleX = window.innerWidth + 300;
    if (score % 3 === 0) speed += 0.4;
  }

  const p = player.getBoundingClientRect();
  const o = obstacle.getBoundingClientRect();
  if (p.right > o.left && p.left < o.right && p.bottom > o.top && p.top < o.bottom) {
    endGame();
    return;
  }

  requestAnimationFrame(gameLoop);
}

/* START */
function startGame() {
  unlockAudio();
  running = true;
  isGameOver = false;
  score = 0;
  speed = 4;
  y = 0;
  velocity = 0;
  obstacleX = window.innerWidth;
  scoreText.textContent = score;
  startText.style.display = "none";
  gameOverScreen.style.display = "none";

  if (soundOn) {
    bgm.currentTime = 0;
    bgm.play();
  }

  requestAnimationFrame(gameLoop);
}

/* END */
function endGame() {
  running = false;
  isGameOver = true;
  bgm.pause();
  if (soundOn) {
    gameOverSound.currentTime = 0;
    gameOverSound.play();
  }
  finalScore.textContent = "Score: " + score;
  gameOverScreen.style.display = "flex";
}

/* JUMP */
function jump() {
  unlockAudio();
  if (isGameOver) return;
  if (!running) startGame();
  if (y === 0) {
    velocity = 18;
    if (soundOn) {
      jumpSound.currentTime = 0;
      jumpSound.play();
    }
  }
}

/* CONTROLS */
document.addEventListener("keydown", e => {
  if (e.code === "Space") jump();
});

game.addEventListener("touchstart", e => {
  jump();
});

/* RESTART */
restartBtn.addEventListener("click", () => {
  startGame();
});
</script>
</body>
</html>
